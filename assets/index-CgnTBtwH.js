(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function h(l){let e=l.length;for(;e!=0;){let t=Math.floor(Math.random()*e);e--,[l[e],l[t]]=[l[t],l[e]]}}class a{#o;#r;#t;#e;element;constructor(e,t,s,o=!1){this.#o=t,this.#r=e,this.#t=s,this.#e=o,this.element=this.#s(),this.open&&this.show()}#s(){let e=document.createElement("div");return e.classList.add("card"),e.dataset.color=this.#t,e.dataset.open=this.#e,e.style.backgroundColor=this.#e?this.#t:"black",e}show(){this.element.style.backgroundColor=this.#t}hide(){this.#e||(this.element.style.backgroundColor="black")}markAsOpen(){this.#e=!0,this.element.dataset.open=!0}isOpen(){return this.#e}getColor(){return this.#t}get row(){return this.#r}get col(){return this.#o}get open(){return this.#e}}class m{min;sec;ms;count;malt;salt;msalt;idElement;constructor(e="timer"){if(console.log("Creamos un Timer"),this.idElement=e,localStorage.getItem("timer")!==null){let t=JSON.parse(localStorage.getItem("timer"));this.sec=parseInt(t.sec),this.min=0,this.ms=parseInt(t.ms)}else this.ms=0,this.min=0,this.sec=0}start(){this.count=setInterval(()=>{if(this.ms==100)if(this.ms=0,this.sec==60)this.sec=0,this.min++;else{if(this.sec%2==0){let e={sec:this.sec,ms:this.ms,min:this.min};localStorage.setItem("timer",JSON.stringify(e))}this.sec++}else this.ms++;this.malt=this.pad(this.min),this.salt=this.pad(this.sec),this.msalt=this.pad(this.ms),this.update(this.malt+":"+this.salt+":"+this.msalt)},10)}stop(){clearInterval(this.count)}update(e){let t=document.getElementById(this.idElement);t.firstChild.nodeValue=e}pad(e){let t;return e<10?t="0"+e:t=e,t}}class c{#o;#r;#t;#e;#s;#i;timer;constructor(e,t,s="game"){this.#o=e,this.#r=t,this.#e=[],this.#s=[],this.#i=[],this.#t=document.getElementById(s),this.createCards(),this.setCSSBoxTemplates(),this.initTimer()}createRandomColors(){let e=[];for(let s=0;s<this.#o*this.#r/2;s++){let o=Math.floor(Math.random()*256),r=Math.floor(Math.random()*256),i=Math.floor(Math.random()*256);e.push(`rgb(${o}, ${r}, ${i})`)}let t=[...e,...e];return h(t),t}createCards(){if(this.#e=[],localStorage.getItem("cards")!==null)JSON.parse(localStorage.getItem("cards")).map(t=>{let s=new a(t.row,t.col,t.color,t.open===!0);this.#e.push(s),this.#t.append(s.element),s.element.addEventListener("click",()=>this.#l(s)),s.isOpen()&&this.#i.push(s.element)}),this.#a();else{let e=0,t=this.createRandomColors();for(let s=0;s<this.#o;s++)for(let o=0;o<this.#r;o++){let r=t[e++],i=new a(s,o,r);this.#e.push(i),this.#t.append(i.element),i.element.addEventListener("click",()=>this.#l(i))}this.saveInLocalStorage()}}saveInLocalStorage(){let e=this.#e.map(t=>({row:t.row,col:t.col,color:t.getColor(),open:t.isOpen()}));localStorage.setItem("cards",JSON.stringify(e))}#l(e){if(!(e.isOpen()||this.#s.includes(e))&&(e.show(),this.#s.push(e),this.#s.length===2)){const[t,s]=this.#s;t.getColor()===s.getColor()?(t.markAsOpen(),s.markAsOpen(),this.#i.push(t.element,s.element),this.saveInLocalStorage(),this.#a()):setTimeout(()=>{t.hide(),s.hide()},200),this.#s=[]}}#a(){this.#i.length==this.#e.length&&setTimeout(()=>{this.timer.stop(),alert("Juego finalizado!!!")},200)}setCSSBoxTemplates(){this.#t.style.gridTemplateColumns=`repeat(${this.#r}, 1fr)`,this.#t.style.gridTemplateRows=`repeat(${this.#o}, 1fr)`}static getRowsCols(){let e,t;if(localStorage.getItem("rows")!==null&&localStorage.getItem("cols")!==null)e=parseInt(localStorage.getItem("rows")),t=parseInt(localStorage.getItem("cols"));else{for(e=prompt("Introduzca número de filas"),t=prompt("Introduzca número de columnas");e*t%2!=0;)alert("El número de cartas debe ser un número par."),e=Number(prompt("Introduzca el número de filas")),t=Number(prompt("Introduzca el número de columnas"));localStorage.setItem("rows",e),localStorage.setItem("cols",t)}return{rows:e,cols:t}}initTimer(){this.timer=new m,this.timer.start()}}let n=c.getRowsCols();new c(n.rows,n.cols,"game");let d=document.getElementsByClassName("resetButton")[0];d.addEventListener("click",()=>{localStorage.clear(),location.reload()});
